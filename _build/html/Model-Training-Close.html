
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Modelado: Precio de Cierre &#8212; MiniProyecto 2 - Aplicaci√≥n de Series de Tiempo</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Model-Training-Close';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Modelado: Volatilidad" href="Model-Training-Volatility.html" />
    <link rel="prev" title="Proyecto Integrador de Deep Learning #2" href="EDA-Volatility.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">MiniProyecto 2 - Aplicaci√≥n de Series de Tiempo</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Predicci√≥n del Precio de Cierre/Volatilidad del BitCoin
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="EDA-Volatility.html"><strong>Proyecto Integrador de Deep Learning #2</strong></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Modelado: Precio de Cierre</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Model-Training-Volatility.html"><strong>Modelado: Volatilidad</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Analysis.html"><em><strong>An√°lisis de Resultados</strong></em></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FModel-Training-Close.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Model-Training-Close.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Modelado: Precio de Cierre</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split-temporal-y-validacion-cruzada"><strong>Split Temporal y Validaci√≥n Cruzada</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelado-con-deep-learning"><strong>Modelado con Deep Learning</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tabla-de-resumen-comparativo-por-lags"><em>Tabla de Resumen Comparativo por Lags</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tablas-de-metricas-resumen-por-horizonte-y-por-fold"><em>Tablas de Metricas: Resumen por Horizonte y por Fold</em></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="modelado-precio-de-cierre">
<h1><strong>Modelado: Precio de Cierre</strong><a class="headerlink" href="#modelado-precio-de-cierre" title="Link to this heading">#</a></h1>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">btc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://raw.githubusercontent.com/TawnyVTC/Proyectos_UN/refs/heads/main/2025/Deep_Learning/Data/btc_1d_with_volatility_and_lags.csv&#39;</span><span class="p">)</span>
<span class="n">btc</span><span class="p">[</span><span class="s1">&#39;Open time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">btc</span><span class="p">[</span><span class="s1">&#39;Open time&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="split-temporal-y-validacion-cruzada">
<h2><strong>Split Temporal y Validaci√≥n Cruzada</strong><a class="headerlink" href="#split-temporal-y-validacion-cruzada" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Precio de Cierre</span>

<span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">,</span> <span class="s1">&#39;LogReturn&#39;</span><span class="p">,</span> <span class="s1">&#39;Volatility&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Close_lag_7&#39;</span><span class="p">,</span> <span class="s1">&#39;Close_lag_14&#39;</span><span class="p">,</span> <span class="s1">&#39;Close_lag_21&#39;</span><span class="p">,</span> <span class="s1">&#39;Close_lag_28&#39;</span><span class="p">]</span>

<span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;target_t+1&#39;</span><span class="p">,</span><span class="s1">&#39;target_t+2&#39;</span><span class="p">,</span><span class="s1">&#39;target_t+3&#39;</span><span class="p">,</span>
           <span class="s1">&#39;target_t+4&#39;</span><span class="p">,</span><span class="s1">&#39;target_t+5&#39;</span><span class="p">,</span><span class="s1">&#39;target_t+6&#39;</span><span class="p">,</span><span class="s1">&#39;target_t+7&#39;</span><span class="p">]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">btc</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">btc</span><span class="p">[</span><span class="n">targets</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">dates</span> <span class="o">=</span> <span class="n">btc</span><span class="p">[</span><span class="s2">&quot;Open time&quot;</span><span class="p">]</span>

<span class="c1"># -----------------------</span>
<span class="c1"># Construcci√≥n del objeto timeSeries</span>
<span class="c1"># -----------------------</span>
<span class="c1"># Si la funci√≥n espera un formato [X, y] concatenado:</span>
<span class="n">timeSeries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tsxv.splitTrainValTest</span> <span class="kn">import</span> <span class="n">split_train_val_test_groupKFold</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">_ensure_2d</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convierte el array a formato 2D.</span>
<span class="sd">    Si llega 1D ‚Üí (n,1); si llega 3D ‚Üí (n, timesteps*feats)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">arr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">arr</span>
    <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">return</span> <span class="n">arr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Array con ndim=</span><span class="si">{</span><span class="n">arr</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2"> no soportado por esta funci√≥n.&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">split_and_scale</span><span class="p">(</span><span class="n">timeSeries</span><span class="p">,</span> <span class="n">n_steps_input</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">n_steps_forecast</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">n_steps_jump</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">X_list</span><span class="p">,</span> <span class="n">y_list</span><span class="p">,</span> <span class="n">Xcv_list</span><span class="p">,</span> <span class="n">ycv_list</span><span class="p">,</span> <span class="n">Xtest_list</span><span class="p">,</span> <span class="n">ytest_list</span> <span class="o">=</span> <span class="n">split_train_val_test_groupKFold</span><span class="p">(</span>
        <span class="n">timeSeries</span><span class="p">,</span>
        <span class="n">n_steps_input</span><span class="p">,</span>
        <span class="n">n_steps_forecast</span><span class="p">,</span>
        <span class="n">n_steps_jump</span>
    <span class="p">)</span>

    <span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">X_val_scaled</span><span class="p">,</span> <span class="n">X_test_scaled</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">y_train_scaled</span><span class="p">,</span> <span class="n">y_val_scaled</span><span class="p">,</span> <span class="n">y_test_scaled</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">scalers_x</span><span class="p">,</span> <span class="n">scalers_y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_list</span><span class="p">)):</span>
        <span class="n">X_train_raw</span> <span class="o">=</span> <span class="n">_ensure_2d</span><span class="p">(</span><span class="n">X_list</span><span class="p">[</span><span class="n">fold</span><span class="p">])</span>
        <span class="n">X_val_raw</span>   <span class="o">=</span> <span class="n">_ensure_2d</span><span class="p">(</span><span class="n">Xcv_list</span><span class="p">[</span><span class="n">fold</span><span class="p">])</span>
        <span class="n">X_test_raw</span>  <span class="o">=</span> <span class="n">_ensure_2d</span><span class="p">(</span><span class="n">Xtest_list</span><span class="p">[</span><span class="n">fold</span><span class="p">])</span>

        <span class="c1"># üëá Aqu√≠ filtramos solo la variable objetivo (columna target)</span>
        <span class="n">y_train_raw</span> <span class="o">=</span> <span class="n">_ensure_2d</span><span class="p">(</span><span class="n">y_list</span><span class="p">[</span><span class="n">fold</span><span class="p">])[:,</span> <span class="n">target_col</span><span class="p">:</span><span class="n">target_col</span> <span class="o">+</span> <span class="n">n_steps_forecast</span><span class="p">]</span>
        <span class="n">y_val_raw</span>   <span class="o">=</span> <span class="n">_ensure_2d</span><span class="p">(</span><span class="n">ycv_list</span><span class="p">[</span><span class="n">fold</span><span class="p">])[:,</span> <span class="n">target_col</span><span class="p">:</span><span class="n">target_col</span> <span class="o">+</span> <span class="n">n_steps_forecast</span><span class="p">]</span>
        <span class="n">y_test_raw</span>  <span class="o">=</span> <span class="n">_ensure_2d</span><span class="p">(</span><span class="n">ytest_list</span><span class="p">[</span><span class="n">fold</span><span class="p">])[:,</span> <span class="n">target_col</span><span class="p">:</span><span class="n">target_col</span> <span class="o">+</span> <span class="n">n_steps_forecast</span><span class="p">]</span>

        <span class="c1"># Escaladores</span>
        <span class="n">scaler_x</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_raw</span><span class="p">)</span>
        <span class="n">scaler_y</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_train_raw</span><span class="p">)</span>

        <span class="n">X_train_scaled</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scaler_x</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train_raw</span><span class="p">))</span>
        <span class="n">X_val_scaled</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scaler_x</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_val_raw</span><span class="p">))</span>
        <span class="n">X_test_scaled</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scaler_x</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test_raw</span><span class="p">))</span>
        <span class="n">y_train_scaled</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scaler_y</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_train_raw</span><span class="p">))</span>
        <span class="n">y_val_scaled</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scaler_y</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_val_raw</span><span class="p">))</span>
        <span class="n">y_test_scaled</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scaler_y</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_test_raw</span><span class="p">))</span>

        <span class="n">scalers_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scaler_x</span><span class="p">)</span>
        <span class="n">scalers_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scaler_y</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fold </span><span class="si">{</span><span class="n">fold</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: train </span><span class="si">{</span><span class="n">X_train_raw</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> -&gt; val </span><span class="si">{</span><span class="n">X_val_raw</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> -&gt; test </span><span class="si">{</span><span class="n">X_test_raw</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;X_train&#39;</span><span class="p">:</span> <span class="n">X_train_scaled</span><span class="p">,</span>
        <span class="s1">&#39;X_val&#39;</span><span class="p">:</span> <span class="n">X_val_scaled</span><span class="p">,</span>
        <span class="s1">&#39;X_test&#39;</span><span class="p">:</span> <span class="n">X_test_scaled</span><span class="p">,</span>
        <span class="s1">&#39;y_train&#39;</span><span class="p">:</span> <span class="n">y_train_scaled</span><span class="p">,</span>
        <span class="s1">&#39;y_val&#39;</span><span class="p">:</span> <span class="n">y_val_scaled</span><span class="p">,</span>
        <span class="s1">&#39;y_test&#39;</span><span class="p">:</span> <span class="n">y_test_scaled</span><span class="p">,</span>
        <span class="s1">&#39;scalers_x&#39;</span><span class="p">:</span> <span class="n">scalers_x</span><span class="p">,</span>
        <span class="s1">&#39;scalers_y&#39;</span><span class="p">:</span> <span class="n">scalers_y</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="modelado-con-deep-learning">
<h2><strong>Modelado con Deep Learning</strong><a class="headerlink" href="#modelado-con-deep-learning" title="Link to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.callbacks</span> <span class="kn">import</span> <span class="n">EarlyStopping</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">entrenar_mlp_folds</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">n_outputs</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">verbose_fit</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Versi√≥n extendida:</span>
<span class="sd">    - Devuelve: resultados (lista), tablas_folds (lista de df_metrics por fold)</span>
<span class="sd">    - Cada df_metrics tiene m√©tricas por horizonte + fila &#39;Promedio&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tablas_folds</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;X_train&#39;</span><span class="p">])):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">===== Fold </span><span class="si">{</span><span class="n">fold</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;X_train&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> =====&quot;</span><span class="p">)</span>

        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;X_train&#39;</span><span class="p">][</span><span class="n">fold</span><span class="p">],</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;X_val&#39;</span><span class="p">][</span><span class="n">fold</span><span class="p">],</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;X_test&#39;</span><span class="p">][</span><span class="n">fold</span><span class="p">]</span>
        <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;y_train&#39;</span><span class="p">][</span><span class="n">fold</span><span class="p">],</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;y_val&#39;</span><span class="p">][</span><span class="n">fold</span><span class="p">],</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;y_test&#39;</span><span class="p">][</span><span class="n">fold</span><span class="p">]</span>
        <span class="n">scaler_y</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;scalers_y&#39;</span><span class="p">][</span><span class="n">fold</span><span class="p">]</span>

        <span class="c1"># --- Modelo ---</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span>
            <span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],)),</span>
            <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">),</span>
            <span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
            <span class="n">Dense</span><span class="p">(</span><span class="n">n_outputs</span><span class="p">)</span>
        <span class="p">])</span>
        <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">)</span>

        <span class="n">es</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">),</span>
                  <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose_fit</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">es</span><span class="p">])</span>

        <span class="c1"># --- Predicciones (desescaladas) ---</span>
        <span class="n">yhat_train</span> <span class="o">=</span> <span class="n">scaler_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
        <span class="n">yhat_val</span> <span class="o">=</span> <span class="n">scaler_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">))</span>
        <span class="n">yhat_test</span> <span class="o">=</span> <span class="n">scaler_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
        <span class="n">ytrain_real</span> <span class="o">=</span> <span class="n">scaler_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
        <span class="n">yval_real</span> <span class="o">=</span> <span class="n">scaler_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_val</span><span class="p">)</span>
        <span class="n">ytest_real</span> <span class="o">=</span> <span class="n">scaler_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>

        <span class="c1"># --- M√©tricas por horizonte (test) ---</span>
        <span class="n">df_metrics</span> <span class="o">=</span> <span class="n">_calc_metrics_per_horizon</span><span class="p">(</span><span class="n">ytest_real</span><span class="p">,</span> <span class="n">yhat_test</span><span class="p">)</span>
        <span class="c1"># a√±adir fila promedio</span>
        <span class="n">promedio</span> <span class="o">=</span> <span class="n">df_metrics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="n">promedio</span><span class="p">[</span><span class="s1">&#39;Horizonte&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Promedio&#39;</span>
        <span class="n">df_metrics</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_metrics</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">promedio</span><span class="p">])],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># p-value BDS en residuos del horizonte 1 (h=1)</span>
        <span class="n">resid_h1</span> <span class="o">=</span> <span class="n">ytest_real</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">yhat_test</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pval</span> <span class="o">=</span> <span class="n">test_independencia_residuos</span><span class="p">(</span><span class="n">resid_h1</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">pval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="c1"># agregamos columna BDS_pvalue_h1 (solo en la primera fila ser√° pval)</span>
        <span class="n">bds_col</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_metrics</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_metrics</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">bds_col</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">pval</span>
        <span class="n">df_metrics</span><span class="p">[</span><span class="s1">&#39;BDS_pvalue_h1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bds_col</span>

        <span class="c1"># print resumen por fold</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fold </span><span class="si">{</span><span class="n">fold</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> | RMSE prom: </span><span class="si">{</span><span class="n">df_metrics</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_metrics</span><span class="p">[</span><span class="s1">&#39;Horizonte&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Promedio&#39;</span><span class="p">,</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> | pval(h1): </span><span class="si">{</span><span class="n">pval</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">resultados</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;fold&#39;</span><span class="p">:</span> <span class="n">fold</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;rmse_test_prom&#39;</span><span class="p">:</span> <span class="n">df_metrics</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_metrics</span><span class="p">[</span><span class="s1">&#39;Horizonte&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Promedio&#39;</span><span class="p">,</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;pval_h1&#39;</span><span class="p">:</span> <span class="n">pval</span><span class="p">,</span>
            <span class="s1">&#39;y_train_real&#39;</span><span class="p">:</span> <span class="n">ytrain_real</span><span class="p">,</span> <span class="s1">&#39;y_train_pred&#39;</span><span class="p">:</span> <span class="n">yhat_train</span><span class="p">,</span>
            <span class="s1">&#39;y_val_real&#39;</span><span class="p">:</span> <span class="n">yval_real</span><span class="p">,</span> <span class="s1">&#39;y_val_pred&#39;</span><span class="p">:</span> <span class="n">yhat_val</span><span class="p">,</span>
            <span class="s1">&#39;y_test_real&#39;</span><span class="p">:</span> <span class="n">ytest_real</span><span class="p">,</span> <span class="s1">&#39;y_test_pred&#39;</span><span class="p">:</span> <span class="n">yhat_test</span><span class="p">,</span>
            <span class="s1">&#39;df_metrics&#39;</span><span class="p">:</span> <span class="n">df_metrics</span>
        <span class="p">})</span>

        <span class="n">tablas_folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_metrics</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">resultados</span><span class="p">,</span> <span class="n">tablas_folds</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Funci√≥n principal: eval√∫a lista de lags y devuelve todo lo necesario</span>
<span class="c1"># ------------------------------------------------------------------</span>

<span class="k">def</span> <span class="nf">evaluar_y_reportar</span><span class="p">(</span><span class="n">timeSeries</span><span class="p">,</span> <span class="n">lags_list</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">28</span><span class="p">],</span> <span class="n">n_outputs</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                        <span class="n">epochs</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">verbose_fit</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ejecuta todo el flujo para cada n_lag:</span>
<span class="sd">    - split + scale</span>
<span class="sd">    - entrenar por folds</span>
<span class="sd">    - guarda tablas por fold y resumen por lag (mean + std)</span>
<span class="sd">    - devuelve estructura con todo para plotting y tablas</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">todos_lags</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">comparativa_resumen</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">n_lag</span> <span class="ow">in</span> <span class="n">lags_list</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Procesando n_lag = </span><span class="si">{</span><span class="n">n_lag</span><span class="si">}</span><span class="s2"> ===&quot;</span><span class="p">)</span>
        <span class="n">data_dict</span> <span class="o">=</span> <span class="n">split_and_scale</span><span class="p">(</span><span class="n">timeSeries</span><span class="p">,</span> <span class="n">n_steps_input</span><span class="o">=</span><span class="n">n_lag</span><span class="p">,</span> <span class="n">n_steps_forecast</span><span class="o">=</span><span class="n">n_outputs</span><span class="p">)</span>
        <span class="n">resultados</span><span class="p">,</span> <span class="n">tablas_folds</span> <span class="o">=</span> <span class="n">entrenar_mlp_folds</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">n_outputs</span><span class="o">=</span><span class="n">n_outputs</span><span class="p">,</span>
                                                     <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                                                     <span class="n">verbose_fit</span><span class="o">=</span><span class="n">verbose_fit</span><span class="p">)</span>

        <span class="c1"># df concatenado de m√©tricas (todos los folds)</span>
        <span class="n">df_metricas_comb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tablas_folds</span><span class="p">],</span> <span class="n">keys</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tablas_folds</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
                                      <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fold&#39;</span><span class="p">,</span><span class="s1">&#39;row&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="c1"># resumen por horizonte (mean, std)</span>
        <span class="n">df_summary_h</span> <span class="o">=</span> <span class="n">resumen_por_lag</span><span class="p">(</span><span class="n">tablas_folds</span><span class="p">)</span>

        <span class="c1"># resumen global (media de RMSE, MAE, MAPE, MSE y pval promedio)</span>
        <span class="n">rmse_prom</span> <span class="o">=</span> <span class="n">df_metricas_comb</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Horizonte&#39;</span><span class="p">)[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># promedio de horizontes</span>
        <span class="n">mae_prom</span>  <span class="o">=</span> <span class="n">df_metricas_comb</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Horizonte&#39;</span><span class="p">)[</span><span class="s1">&#39;MAE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">mape_prom</span> <span class="o">=</span> <span class="n">df_metricas_comb</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Horizonte&#39;</span><span class="p">)[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">mse_prom</span>  <span class="o">=</span> <span class="n">df_metricas_comb</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Horizonte&#39;</span><span class="p">)[</span><span class="s1">&#39;MSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">pvals</span> <span class="o">=</span> <span class="n">df_metricas_comb</span><span class="p">[</span><span class="s1">&#39;BDS_pvalue_h1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="n">pval_prom</span> <span class="o">=</span> <span class="n">pvals</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pvals</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="n">comparativa_resumen</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;n_lag&#39;</span><span class="p">:</span> <span class="n">n_lag</span><span class="p">,</span>
            <span class="s1">&#39;RMSE_prom&#39;</span><span class="p">:</span> <span class="n">rmse_prom</span><span class="p">,</span>
            <span class="s1">&#39;RMSE_std&#39;</span><span class="p">:</span> <span class="n">df_metricas_comb</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Horizonte&#39;</span><span class="p">)[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span>
            <span class="s1">&#39;MAE_prom&#39;</span><span class="p">:</span> <span class="n">mae_prom</span><span class="p">,</span>
            <span class="s1">&#39;MAPE_prom&#39;</span><span class="p">:</span> <span class="n">mape_prom</span><span class="p">,</span>
            <span class="s1">&#39;MSE_prom&#39;</span><span class="p">:</span> <span class="n">mse_prom</span><span class="p">,</span>
            <span class="s1">&#39;BDS_pvalue_h1_prom&#39;</span><span class="p">:</span> <span class="n">pval_prom</span>
        <span class="p">})</span>

        <span class="n">todos_lags</span><span class="p">[</span><span class="n">n_lag</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;resultados&#39;</span><span class="p">:</span> <span class="n">resultados</span><span class="p">,</span>         <span class="c1"># lista de dict por fold (incluye df_metrics por fold)</span>
            <span class="s1">&#39;tablas_folds&#39;</span><span class="p">:</span> <span class="n">tablas_folds</span><span class="p">,</span>     <span class="c1"># lista de dataframes por fold</span>
            <span class="s1">&#39;df_metricas_comb&#39;</span><span class="p">:</span> <span class="n">df_metricas_comb</span><span class="p">,</span>
            <span class="s1">&#39;df_summary_h&#39;</span><span class="p">:</span> <span class="n">df_summary_h</span>
        <span class="p">}</span>

    <span class="n">df_comparativa</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">comparativa_resumen</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;n_lag&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">todos_lags</span><span class="p">,</span> <span class="n">df_comparativa</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1) Ejecutar evaluaci√≥n completa</span>
<span class="n">todos_lags</span><span class="p">,</span> <span class="n">df_comparativa</span> <span class="o">=</span> <span class="n">evaluar_y_reportar</span><span class="p">(</span><span class="n">timeSeries</span><span class="p">,</span> <span class="n">lags_list</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">28</span><span class="p">],</span>
                                                <span class="n">n_outputs</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
                                                <span class="n">verbose_fit</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Procesando n_lag = 7 ===
Fold 1: train (331, 98) -&gt; val (109, 98) -&gt; test (109, 98)
Fold 2: train (330, 98) -&gt; val (109, 98) -&gt; test (109, 98)
Fold 3: train (329, 98) -&gt; val (110, 98) -&gt; test (109, 98)
Fold 4: train (328, 98) -&gt; val (110, 98) -&gt; test (109, 98)
Fold 5: train (327, 98) -&gt; val (110, 98) -&gt; test (110, 98)

===== Fold 1/5 =====
<span class=" -Color -Color-Bold">11/11</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 13ms/step
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 11ms/step
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 15ms/step
Fold 1 | RMSE prom: 1745.5384 | pval(h1): 0.8967076193728124

===== Fold 2/5 =====
<span class=" -Color -Color-Bold">11/11</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 9ms/step
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 9ms/step 
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 18ms/step
Fold 2 | RMSE prom: 1771.4336 | pval(h1): 0.8420617783913587

===== Fold 3/5 =====
<span class=" -Color -Color-Bold">11/11</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 10ms/step
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 10ms/step
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 10ms/step
Fold 3 | RMSE prom: 2222.6178 | pval(h1): 0.12161391817407531

===== Fold 4/5 =====
<span class=" -Color -Color-Bold">11/11</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 8ms/step
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 8ms/step 
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 14ms/step
Fold 4 | RMSE prom: 2463.3095 | pval(h1): 3.833859712011076e-05

===== Fold 5/5 =====
<span class=" -Color -Color-Bold">11/11</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 7ms/step 
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 8ms/step 
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 9ms/step 
Fold 5 | RMSE prom: 2838.5127 | pval(h1): 0.3959812453605836

=== Procesando n_lag = 14 ===
Fold 1: train (172, 196) -&gt; val (57, 196) -&gt; test (57, 196)
Fold 2: train (172, 196) -&gt; val (57, 196) -&gt; test (57, 196)
Fold 3: train (172, 196) -&gt; val (57, 196) -&gt; test (57, 196)
Fold 4: train (172, 196) -&gt; val (57, 196) -&gt; test (57, 196)
Fold 5: train (171, 196) -&gt; val (58, 196) -&gt; test (57, 196)

===== Fold 1/5 =====
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 15ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 21ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 31ms/step
Fold 1 | RMSE prom: 3475.7327 | pval(h1): 0.043771008817923195

===== Fold 2/5 =====
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 15ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 22ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 16ms/step
Fold 2 | RMSE prom: 3646.9040 | pval(h1): 0.4688674954711407

===== Fold 3/5 =====
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 15ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 25ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 26ms/step
Fold 3 | RMSE prom: 3506.0016 | pval(h1): 0.3097691718010657

===== Fold 4/5 =====
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 13ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 22ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 22ms/step
Fold 4 | RMSE prom: 3202.2968 | pval(h1): 0.3122840958670891

===== Fold 5/5 =====
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 28ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 35ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 48ms/step
Fold 5 | RMSE prom: 2633.0221 | pval(h1): 0.7756048253493135

=== Procesando n_lag = 21 ===
Fold 1: train (118, 294) -&gt; val (39, 294) -&gt; test (38, 294)
Fold 2: train (117, 294) -&gt; val (39, 294) -&gt; test (38, 294)
Fold 3: train (116, 294) -&gt; val (39, 294) -&gt; test (38, 294)
Fold 4: train (115, 294) -&gt; val (39, 294) -&gt; test (38, 294)
Fold 5: train (114, 294) -&gt; val (39, 294) -&gt; test (39, 294)

===== Fold 1/5 =====
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 44ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 25ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 22ms/step
Fold 1 | RMSE prom: 3671.2791 | pval(h1): 0.008995412824131016

===== Fold 2/5 =====
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 33ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 22ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 28ms/step
Fold 2 | RMSE prom: 3021.2355 | pval(h1): 0.7153092414237352

===== Fold 3/5 =====
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 23ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 25ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 25ms/step
Fold 3 | RMSE prom: 3167.8368 | pval(h1): 0.9039473913073516

===== Fold 4/5 =====
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 21ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 23ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 33ms/step
Fold 4 | RMSE prom: 3767.0860 | pval(h1): 0.6334341559329492

===== Fold 5/5 =====
<span class=" -Color -Color-Bold">4/4</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 23ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 42ms/step
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 22ms/step
Fold 5 | RMSE prom: 3956.9243 | pval(h1): 0.20907713738343994

=== Procesando n_lag = 28 ===
Fold 1: train (88, 392) -&gt; val (29, 392) -&gt; test (29, 392)
Fold 2: train (88, 392) -&gt; val (29, 392) -&gt; test (29, 392)
Fold 3: train (88, 392) -&gt; val (29, 392) -&gt; test (29, 392)
Fold 4: train (88, 392) -&gt; val (29, 392) -&gt; test (29, 392)
Fold 5: train (87, 392) -&gt; val (30, 392) -&gt; test (29, 392)

===== Fold 1/5 =====
<span class=" -Color -Color-Bold">3/3</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 30ms/step
<span class=" -Color -Color-Bold">1/1</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 40ms/step
<span class=" -Color -Color-Bold">1/1</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 30ms/step
Fold 1 | RMSE prom: 3475.0993 | pval(h1): 0.7457953444678931

===== Fold 2/5 =====
<span class=" -Color -Color-Bold">1/3</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span><span class=" -Color -Color-White">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 102ms/stepWARNING:tensorflow:5 out of the last 13 calls to &lt;function TensorFlowTrainer.make_predict_function.&lt;locals&gt;.one_step_on_data_distributed at 0x00000178565985E0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
<span class=" -Color -Color-Bold">3/3</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 54ms/step
<span class=" -Color -Color-Bold">1/1</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 84ms/step
<span class=" -Color -Color-Bold">1/1</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 131ms/step
Fold 2 | RMSE prom: 3526.3675 | pval(h1): 0.08384138187350341

===== Fold 3/5 =====
WARNING:tensorflow:5 out of the last 11 calls to &lt;function TensorFlowTrainer.make_predict_function.&lt;locals&gt;.one_step_on_data_distributed at 0x0000017856C309A0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
<span class=" -Color -Color-Bold">3/3</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 59ms/step
<span class=" -Color -Color-Bold">1/1</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 216ms/step
<span class=" -Color -Color-Bold">1/1</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 129ms/step
Fold 3 | RMSE prom: 4106.9088 | pval(h1): 0.37901339679054014

===== Fold 4/5 =====
<span class=" -Color -Color-Bold">3/3</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 43ms/step
<span class=" -Color -Color-Bold">1/1</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 50ms/step
<span class=" -Color -Color-Bold">1/1</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 56ms/step
Fold 4 | RMSE prom: 3853.5189 | pval(h1): 0.18250707115911405

===== Fold 5/5 =====
<span class=" -Color -Color-Bold">3/3</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 32ms/step
<span class=" -Color -Color-Bold">1/1</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 50ms/step
<span class=" -Color -Color-Bold">1/1</span> <span class=" -Color -Color-Green">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span> <span class=" -Color -Color-Bold">0s</span> 57ms/step
Fold 5 | RMSE prom: 3969.9337 | pval(h1): 0.6894879486625127
</pre></div>
</div>
</div>
</div>
<section id="tabla-de-resumen-comparativo-por-lags">
<h3><em>Tabla de Resumen Comparativo por Lags</em><a class="headerlink" href="#tabla-de-resumen-comparativo-por-lags" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 2) Ver tabla resumen comparativa de los 4 lags:</span>
<span class="n">df_comparativa</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;C:\DeepLearning\DL_Proyecto_2\data\precio_cierre\tablas\resumen_comparativo.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df_comparativa</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>n_lag</th>
      <th>RMSE_prom</th>
      <th>RMSE_std</th>
      <th>MAE_prom</th>
      <th>MAPE_prom</th>
      <th>MSE_prom</th>
      <th>BDS_pvalue_h1_prom</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>2208.282385</td>
      <td>1413.423755</td>
      <td>1615.290503</td>
      <td>55.326414</td>
      <td>7.168180e+06</td>
      <td>0.451281</td>
    </tr>
    <tr>
      <th>1</th>
      <td>14</td>
      <td>3292.791440</td>
      <td>2094.215359</td>
      <td>2370.556816</td>
      <td>90.512134</td>
      <td>1.560422e+07</td>
      <td>0.382059</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21</td>
      <td>3516.872377</td>
      <td>2243.514903</td>
      <td>2563.970619</td>
      <td>48.764169</td>
      <td>1.781065e+07</td>
      <td>0.494153</td>
    </tr>
    <tr>
      <th>3</th>
      <td>28</td>
      <td>3786.365659</td>
      <td>2434.557203</td>
      <td>2851.605577</td>
      <td>60.246984</td>
      <td>2.084163e+07</td>
      <td>0.416129</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="tablas-de-metricas-resumen-por-horizonte-y-por-fold">
<h3><em>Tablas de Metricas: Resumen por Horizonte y por Fold</em><a class="headerlink" href="#tablas-de-metricas-resumen-por-horizonte-y-por-fold" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados_lag_precio</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Fold 1 ---
  Horizonte          MAE           MSE         RMSE        MAPE  BDS_pvalue_h1
0         1  1735.026344  4.911803e+06  2216.258861    9.705390       0.896708
1         2     0.021002  9.858301e-04     0.031398  370.173970            NaN
2         3     0.040650  3.104367e-03     0.055717    7.039458            NaN
3         4  1635.433658  5.398253e+06  2323.413991    8.510498            NaN
4         5  1651.235078  4.988690e+06  2233.537615   11.084910            NaN
5         6  1796.076522  7.228901e+06  2688.661617    9.775077            NaN
6         7  2035.672875  7.599997e+06  2756.809284   10.430466            NaN
7  Promedio  1264.786590  4.303949e+06  1745.538355   60.959967            NaN

--- Fold 2 ---
  Horizonte          MAE           MSE         RMSE        MAPE  BDS_pvalue_h1
0         1  1895.433750  6.203154e+06  2490.613079   10.754533       0.842062
1         2     0.026320  1.334892e-03     0.036536  390.335073            NaN
2         3     0.050277  4.505761e-03     0.067125    8.711959            NaN
3         4  1497.505612  4.432959e+06  2105.459430    8.629875            NaN
4         5  1919.040131  5.779794e+06  2404.120210   12.112959            NaN
5         6  1885.607979  5.491395e+06  2343.372620   10.121371            NaN
6         7  2320.937723  9.341373e+06  3056.365944   12.516986            NaN
7  Promedio  1359.800256  4.464096e+06  1771.433563   64.740394            NaN

--- Fold 3 ---
  Horizonte          MAE           MSE         RMSE        MAPE  BDS_pvalue_h1
0         1  2571.851574  1.137228e+07  3372.281150   18.079680       0.121614
1         2     0.025489  1.270823e-03     0.035649  397.973648            NaN
2         3     0.049176  4.198015e-03     0.064792    8.514194            NaN
3         4  1914.400317  7.130760e+06  2670.348371   10.740179            NaN
4         5  2193.722061  8.744898e+06  2957.177292   12.500840            NaN
5         6  2507.721747  1.048987e+07  3238.806243   14.863903            NaN
6         7  2197.039704  1.101982e+07  3319.610889   10.915336            NaN
7  Promedio  1626.401438  6.965374e+06  2222.617769   67.655397            NaN

--- Fold 4 ---
  Horizonte          MAE           MSE         RMSE        MAPE  BDS_pvalue_h1
0         1  2394.229913  1.155928e+07  3399.893485   13.367358       0.000038
1         2     0.022984  1.090483e-03     0.033022  242.729268            NaN
2         3     0.051109  4.693894e-03     0.068512    9.176243            NaN
3         4  2566.163138  1.215533e+07  3486.449102   14.233949            NaN
4         5  2220.456841  8.343640e+06  2888.536000   13.851315            NaN
5         6  2628.080390  1.531032e+07  3912.840061   14.892555            NaN
6         7  2688.943749  1.264049e+07  3555.346509   16.562110            NaN
7  Promedio  1785.421161  8.572721e+06  2463.309527   46.401828            NaN

--- Fold 5 ---
  Horizonte          MAE           MSE         RMSE        MAPE  BDS_pvalue_h1
0         1  2463.900555  1.090691e+07  3302.560488   15.322180       0.395981
1         2     0.022638  1.109012e-03     0.033302  156.005929            NaN
2         3     0.062904  1.273890e-02     0.112867   11.462707            NaN
3         4  2909.006154  1.466870e+07  3829.974483   25.345598            NaN
4         5  2730.589018  1.303705e+07  3610.685447   15.299144            NaN
5         6  3466.869075  2.556732e+07  5056.413447   19.225513            NaN
6         7  2709.851157  1.656334e+07  4069.808936   15.460314            NaN
7  Promedio  2040.043072  1.153476e+07  2838.512710   36.874483            NaN

‚úÖ Resultados y gr√°ficas guardados en: C:\DeepLearning\DL_Proyecto_2\data\precio_cierre\figs\lag_7
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados_lag_precio</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Fold 1 ---
  Horizonte          MAE           MSE         RMSE        MAPE  BDS_pvalue_h1
0         1  3233.590346  1.723555e+07  4151.572035   20.025591       0.043771
1         2     0.022503  1.076387e-03     0.032808  146.455653            NaN
2         3     0.077558  1.675861e-02     0.129455   13.033652            NaN
3         4  3390.903816  2.107813e+07  4591.091995   23.069938            NaN
4         5  3150.933792  1.967249e+07  4435.367854   19.732070            NaN
5         6  3849.734242  2.680600e+07  5177.451179   23.667920            NaN
6         7  3173.518504  3.569445e+07  5974.483407   21.577168            NaN
7  Promedio  2399.825823  1.721237e+07  3475.732676   38.223142            NaN

--- Fold 2 ---
  Horizonte          MAE           MSE         RMSE        MAPE  BDS_pvalue_h1
0         1  4491.185360  3.815902e+07  6177.299105   29.043405       0.468867
1         2     0.027204  1.778403e-03     0.042171  433.888710            NaN
2         3     0.118223  4.196035e-02     0.204842   19.033878            NaN
3         4  3460.393349  2.352046e+07  4849.789442   27.068558            NaN
4         5  3333.936451  2.128381e+07  4613.437997   22.315625            NaN
5         6  3055.383962  1.589827e+07  3987.263010   21.055208            NaN
6         7  4000.557468  3.481344e+07  5900.291525   25.063202            NaN
7  Promedio  2620.228860  1.909643e+07  3646.904013   82.495512            NaN

--- Fold 3 ---
  Horizonte          MAE           MSE         RMSE        MAPE  BDS_pvalue_h1
0         1  3030.433523  1.811654e+07  4256.352765   16.022212       0.309769
1         2     0.027509  1.859317e-03     0.043120  142.440541            NaN
2         3     0.075320  1.039565e-02     0.101959   13.530241            NaN
3         4  3016.288362  1.750963e+07  4184.450441   20.077005            NaN
4         5  4315.943281  2.997133e+07  5474.607648   30.673876            NaN
5         6  4035.157624  2.859227e+07  5347.174428   25.231275            NaN
6         7  3675.461942  2.787081e+07  5279.280874   24.200708            NaN
7  Promedio  2581.912509  1.743722e+07  3506.001605   38.882265            NaN

--- Fold 4 ---
  Horizonte          MAE           MSE         RMSE         MAPE  \
0         1  3138.770935  2.172522e+07  4661.032182    22.867360   
1         2     0.026313  1.342616e-03     0.036642  1651.247322   
2         3     0.085824  2.399835e-02     0.154914    14.448583   
3         4  2898.365020  1.561365e+07  3951.411722    20.861362   
4         5  3429.410909  2.266966e+07  4761.266255    22.496810   
5         6  3176.831500  2.367587e+07  4865.785844    16.365148   
6         7  3279.514990  1.744223e+07  4176.390067    24.985957   
7  Promedio  2274.715070  1.444666e+07  3202.296804   253.324649   

   BDS_pvalue_h1  
0       0.312284  
1            NaN  
2            NaN  
3            NaN  
4            NaN  
5            NaN  
6            NaN  
7            NaN  

--- Fold 5 ---
  Horizonte          MAE           MSE         RMSE        MAPE  BDS_pvalue_h1
0         1  2721.589579  1.507510e+07  3882.667075   16.114242       0.775605
1         2     0.021075  9.557400e-04     0.030915  168.960979            NaN
2         3     0.059817  6.680483e-03     0.081734   11.998277            NaN
3         4  2364.819044  1.087174e+07  3297.231981   17.233649            NaN
4         5  2384.520937  1.127088e+07  3357.213181   13.904501            NaN
5         6  3503.028247  1.942499e+07  4407.379411   29.064058            NaN
6         7  2858.674035  1.215603e+07  3486.550412   20.170005            NaN
7  Promedio  1976.101819  9.828393e+06  2633.022101   39.635101            NaN

‚úÖ Resultados y gr√°ficas guardados en: C:\DeepLearning\DL_Proyecto_2\data\precio_cierre\figs\lag_14
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados_lag_precio</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Fold 1 ---
  Horizonte          MAE           MSE         RMSE        MAPE  BDS_pvalue_h1
0         1  3861.084526  3.754799e+07  6127.641386   35.550880       0.008995
1         2     0.021012  8.379067e-04     0.028947  268.188922            NaN
2         3     0.069382  9.064884e-03     0.095210   13.258544            NaN
3         4  3257.320415  1.892146e+07  4349.881013   25.145508            NaN
4         5  4006.284282  2.835743e+07  5325.169532   24.280615            NaN
5         6  3412.364703  2.192060e+07  4681.944541   23.429817            NaN
6         7  3868.308455  2.718781e+07  5214.193304   28.308608            NaN
7  Promedio  2629.350397  1.913361e+07  3671.279133   59.737556            NaN

--- Fold 2 ---
  Horizonte          MAE           MSE         RMSE        MAPE  BDS_pvalue_h1
0         1  3755.639323  2.361588e+07  4859.616820   23.795991       0.715309
1         2     0.015532  5.293936e-04     0.023009  200.248563            NaN
2         3     0.074870  1.435329e-02     0.119805   12.926161            NaN
3         4  3215.651178  1.694749e+07  4116.733312   23.944229            NaN
4         5  2979.059161  1.621376e+07  4026.631505   19.005555            NaN
5         6  2816.081343  1.225924e+07  3501.320216   21.686381            NaN
6         7  3084.731717  2.156863e+07  4644.204167   20.535669            NaN
7  Promedio  2264.464732  1.294357e+07  3021.235548   46.020364            NaN

--- Fold 3 ---
  Horizonte          MAE           MSE         RMSE        MAPE  BDS_pvalue_h1
0         1  3213.413196  2.474015e+07  4973.947302   15.453587       0.903947
1         2     0.028252  1.818045e-03     0.042639  131.783247            NaN
2         3     0.061710  7.036060e-03     0.083881   10.410906            NaN
3         4  3011.834056  1.414707e+07  3761.258923   20.041680            NaN
4         5  3073.074056  1.371461e+07  3703.323583   19.471639            NaN
5         6  3526.194713  2.298783e+07  4794.562311   25.007040            NaN
6         7  3819.068187  2.441980e+07  4941.639237   27.615086            NaN
7  Promedio  2377.667739  1.428706e+07  3167.836839   35.683312            NaN

--- Fold 4 ---
  Horizonte          MAE           MSE         RMSE        MAPE  BDS_pvalue_h1
0         1  4743.668510  3.265440e+07  5714.402813   29.145996       0.633434
1         2     0.017766  7.501685e-04     0.027389  148.233947            NaN
2         3     0.081122  1.457951e-02     0.120746   14.176719            NaN
3         4  4009.043947  3.337444e+07  5777.061657   30.495853            NaN
4         5  2669.466325  1.245923e+07  3529.763026   15.574511            NaN
5         6  3897.025948  3.491378e+07  5908.788062   26.813562            NaN
6         7  4436.825972  2.958749e+07  5439.438411   31.422613            NaN
7  Promedio  2822.304227  2.042705e+07  3767.086015   42.266172            NaN

--- Fold 5 ---
  Horizonte          MAE           MSE         RMSE        MAPE  BDS_pvalue_h1
0         1  4078.731291  3.074685e+07  5544.983880   30.906149       0.209077
1         2     0.021569  8.891306e-04     0.029818  277.783612            NaN
2         3     0.098346  2.600231e-02     0.161252   15.878972            NaN
3         4  4440.089413  4.701111e+07  6856.465081   35.058484            NaN
4         5  3531.288758  2.837757e+07  5327.060206   21.026354            NaN
5         6  3435.327352  2.482648e+07  4982.617287   22.287015            NaN
6         7  3596.905279  2.487169e+07  4987.152916   17.853517            NaN
7  Promedio  2726.066001  2.226196e+07  3956.924349   60.113443            NaN

‚úÖ Resultados y gr√°ficas guardados en: C:\DeepLearning\DL_Proyecto_2\data\precio_cierre\figs\lag_21
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados_lag_precio</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Fold 1 ---
  Horizonte          MAE           MSE         RMSE        MAPE  BDS_pvalue_h1
0         1  4006.760574  2.677602e+07  5174.555304   28.444437       0.745795
1         2     0.018929  7.860383e-04     0.028036  159.265334            NaN
2         3     0.094704  2.221111e-02     0.149034   14.684018            NaN
3         4  4429.451739  2.886009e+07  5372.159124   25.109386            NaN
4         5  3571.949683  2.533677e+07  5033.564406   24.687273            NaN
5         6  2292.871118  1.248970e+07  3534.077093   16.899919            NaN
6         7  4297.803273  2.715621e+07  5211.161945   23.309130            NaN
7  Promedio  2656.992860  1.723126e+07  3475.099277   41.771357            NaN

--- Fold 2 ---
  Horizonte          MAE           MSE         RMSE        MAPE  BDS_pvalue_h1
0         1  3229.117176  1.575057e+07  3968.699351   20.749108       0.083841
1         2     0.026233  1.042396e-03     0.032286  234.019809            NaN
2         3     0.093080  1.814831e-02     0.134716   14.789034            NaN
3         4  3659.292605  3.096803e+07  5564.892799   27.420348            NaN
4         5  4306.328827  3.051882e+07  5524.384231   37.212324            NaN
5         6  3155.870602  2.173053e+07  4661.601142   22.135825            NaN
6         7  3952.663493  2.464952e+07  4964.828217   28.158046            NaN
7  Promedio  2614.770288  1.765964e+07  3526.367535   54.926356            NaN

--- Fold 3 ---
  Horizonte          MAE           MSE         RMSE        MAPE  BDS_pvalue_h1
0         1  3390.434847  1.935128e+07  4399.008858   21.836590       0.379013
1         2     0.031421  2.085057e-03     0.045662  128.719223            NaN
2         3     0.109045  2.739090e-02     0.165502   18.843004            NaN
3         4  5409.477348  5.149630e+07  7176.092290   34.251611            NaN
4         5  4675.822325  4.268683e+07  6533.515792   26.237285            NaN
5         6  2808.580848  1.188796e+07  3447.892106   26.622575            NaN
6         7  5976.775691  5.171971e+07  7191.641597   40.501832            NaN
7  Promedio  3180.175932  2.530601e+07  4106.908830   42.430303            NaN

--- Fold 4 ---
  Horizonte          MAE           MSE         RMSE        MAPE  BDS_pvalue_h1
0         1  3151.774955  1.800322e+07  4243.019769   22.933114       0.182507
1         2     0.021019  7.129723e-04     0.026702  210.256444            NaN
2         3     0.086975  1.762684e-02     0.132766   14.173719            NaN
3         4  3564.394763  2.147523e+07  4634.137752   28.849620            NaN
4         5  4205.038901  3.911407e+07  6254.123989   26.329269            NaN
5         6  4141.851472  3.890575e+07  6237.447589   36.265482            NaN
6         7  4450.306738  3.142436e+07  5605.743763   23.599832            NaN
7  Promedio  2787.639260  2.127466e+07  3853.518904   51.772497            NaN

--- Fold 5 ---
  Horizonte          MAE           MSE         RMSE        MAPE  BDS_pvalue_h1
0         1  4291.845467  4.699833e+07  6855.533153   16.598684       0.689488
1         2     0.030253  2.099335e-03     0.045818  617.619849            NaN
2         3     0.140688  5.682429e-02     0.238378   19.687646            NaN
3         4  3669.884491  1.879110e+07  4334.870173   26.481717            NaN
4         5  4348.545986  3.122117e+07  5587.590596   25.258902            NaN
5         6  3464.551103  2.146818e+07  4633.376961   24.442380            NaN
6         7  5354.148822  4.067737e+07  6377.881168   42.251668            NaN
7  Promedio  3018.449544  2.273659e+07  3969.933750  110.334407            NaN

‚úÖ Resultados y gr√°ficas guardados en: C:\DeepLearning\DL_Proyecto_2\data\precio_cierre\figs\lag_28
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="EDA-Volatility.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Proyecto Integrador de Deep Learning #2</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="Model-Training-Volatility.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Modelado: Volatilidad</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split-temporal-y-validacion-cruzada"><strong>Split Temporal y Validaci√≥n Cruzada</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelado-con-deep-learning"><strong>Modelado con Deep Learning</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tabla-de-resumen-comparativo-por-lags"><em>Tabla de Resumen Comparativo por Lags</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tablas-de-metricas-resumen-por-horizonte-y-por-fold"><em>Tablas de Metricas: Resumen por Horizonte y por Fold</em></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Tawny Torres
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>